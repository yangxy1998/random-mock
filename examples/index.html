<!DOCTYPE html>
<html>
    <body>
        <div id="menu"></div>
        <canvas id="chart"></canvas>
    </body>
    <script src="./dist/main.js"></script>
    <script src="../build/random-mock.js"></script>
    <script>
        const attributes = [
            {
                name: 'x',
                type: RandMock.AttributeType.Continuous,
                distribution: new RandMock.Distribution.Continuous.Normal(0, 5)
            },
            {
                name: 'y',
                type: RandMock.AttributeType.Continuous,
                distribution: new RandMock.Distribution.Continuous.Uniform([0, 10])
            },
            {
                name: 'z',
                type: RandMock.AttributeType.Continuous,
                distribution: new RandMock.Distribution.Continuous.Exponential(5, 5)
            },
            {
                name: 'region',
                type: RandMock.AttributeType.Discrete,
                distribution: new RandMock.Distribution.Discrete.Standard(['CN', 'US'], [0.8, 0.2])
            },
            {
                name: 'model',
                type: RandMock.AttributeType.Compound,
                distribution: new RandMock.Distribution.Compound({
                    attributes: [
                        {
                            name: 'cpu',
                            type: RandMock.AttributeType.Discrete,
                            distribution: new RandMock.Distribution.Discrete.Standard(
                                ['骁龙870', '骁龙888'],
                                [0.8, 0.2]
                            )
                        },
                        {
                            name: 'memory',
                            type: RandMock.AttributeType.Continuous,
                            distribution: new RandMock.Distribution.Continuous.Normal(8, 0.2)
                        }
                    ],
                    rules: [
                        {
                            dependent: 'memory',
                            arguments: ['cpu'],
                            filter: (cpu) => cpu === '骁龙888',
                            effect: () => RandMock.Distribution.Continuous.Normal.Random(12, 0.01),
                            confidence: 0.99
                        }
                    ]
                })
            },
            {
                name: 'date',
                type: RandMock.AttributeType.Date,
                distribution: new RandMock.Distribution.Date.Uniform(
                    ['2021/01/01 00:00', '2021/12/01 00:00'],
                    'YYYY/MM/DD HH:mm'
                )
            }
        ]
        const rules = [
            {
                dependent: 'y',
                arguments: ['region', 'x'],
                filter: (region) => region === 'US',
                effect: (x) => RandMock.Distribution.Continuous.Normal.Random(-1 * x, 0.5),
                confidence: 0.98
            },
            {
                dependent: 'y',
                arguments: ['x'],
                filter: (x) => x >= 3,
                effect: (x) => RandMock.Distribution.Continuous.Normal.Random(3 * x + 1, 0.5),
                confidence: 0.95
            },
            {
                dependent: 'z',
                arguments: ['x', 'y'],
                effect: (x, y) => x * 2 + y * y,
                confidence: 0.99
            }
        ]
        const config = {
            attributes,
            rules
        }
        let generator = new RandMock.Mocker(config)
        let data = generator.create({
            count: 10000,
            mode: RandMock.DataMode.Table
        })
        console.log(data)
        const chart = new ExampleChart()
        chart.data(attributes, data)
    </script>
</html>
