<!DOCTYPE html>
<html>
    <body>
        <div id="menu"></div>
        <canvas id="chart"></canvas>
    </body>
    <script src="./dist/main.js"></script>
    <script>
        const attributes = [
            {
                name: 'x',
                type: ExampleChart.AttributeType.Continuous,
                distribution: new ExampleChart.Distribution.Continuous.Normal(0, 5)
            },
            {
                name: 'y',
                type: ExampleChart.AttributeType.Continuous,
                distribution: new ExampleChart.Distribution.Continuous.Uniform([0, 10])
            },
            {
                name: 'z',
                type: ExampleChart.AttributeType.Continuous,
                distribution: new ExampleChart.Distribution.Continuous.Normal(5, 2)
            },
            {
                name: 'region',
                type: ExampleChart.AttributeType.Discrete,
                distribution: new ExampleChart.Distribution.Discrete.Discrete(
                    ['CN', 'US'],
                    [0.8, 0.2]
                )
            },
            {
                name: 'model',
                type: ExampleChart.AttributeType.Compound,
                distribution: new ExampleChart.Distribution.Compound({
                    attributes: [
                        {
                            name: 'cpu',
                            type: ExampleChart.AttributeType.Discrete,
                            distribution: new ExampleChart.Distribution.Discrete.Discrete(
                                ['骁龙870', '骁龙888'],
                                [0.8, 0.2]
                            )
                        },
                        {
                            name: 'memory',
                            type: ExampleChart.AttributeType.Continuous,
                            distribution: new ExampleChart.Distribution.Continuous.Normal(8, 0.2)
                        }
                    ],
                    rules: [
                        {
                            dependent: 'memory',
                            arguments: ['cpu'],
                            filter: (cpu) => cpu === '骁龙888',
                            effect: () =>
                                ExampleChart.Distribution.Continuous.Normal.Random(12, 0.01),
                            confidence: 0.99
                        }
                    ]
                })
            },
            {
                name: 'date',
                type: ExampleChart.AttributeType.Date,
                distribution: new ExampleChart.Distribution.Date.Uniform([
                    '2021/01/01 00:00',
                    '2021/12/01 00:00'
                ])
            }
        ]
        const rules = [
            {
                dependent: 'y',
                arguments: ['region', 'x'],
                filter: (region) => region === 'US',
                effect: (x) => ExampleChart.Distribution.Continuous.Normal.Random(-1 * x, 0.5),
                confidence: 0.98
            },
            {
                dependent: 'y',
                arguments: ['x'],
                filter: (x) => x >= 3,
                effect: (x) => ExampleChart.Distribution.Continuous.Normal.Random(3 * x + 1, 0.5),
                confidence: 0.95
            },
            {
                dependent: 'z',
                arguments: ['x', 'y'],
                effect: (x, y) => x * 2 + y * y,
                confidence: 0.99
            }
        ]
        const config = {
            attributes,
            rules
        }

        let generator = new ExampleChart.Mocker(config)
        let data = generator.create({
            count: 1000,
            mode: ExampleChart.DataMode.Object
        })
        const chart = new ExampleChart()
        chart.data(attributes, data)
    </script>
</html>
